<!DOCTYPE html>


  


<html class="theme-next gemini use-motion" lang="zh-Hans">
<head><meta name="generator" content="Hexo 3.8.0">
  <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform">
<meta http-equiv="Cache-Control" content="no-siteapp">
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css">







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css">

<link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.4">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.4" color="#222">





  <meta name="keywords" content="Hexo, NexT">










<meta property="og:type" content="website">
<meta property="og:title" content="妄越">
<meta property="og:url" content="http://yoursite.com/index.html">
<meta property="og:site_name" content="妄越">
<meta property="og:locale" content="zh-Hans">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="妄越">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Gemini',
    version: '5.1.4',
    sidebar: {"position":"right","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://yoursite.com/">





  <title>妄越</title>
  








  
</head>

<body itemscope="" itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <div class="container sidebar-position-right 
  page-home">
    <div class="headband"></div>

    <header id="header" class="header" itemscope="" itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">妄越</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle"></p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br>
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br>
            
            关于
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br>
            
            标签
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br>
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br>
            
            归档
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
	  
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-python" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/01/14/json查找所有地方/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="妄越">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/yifenga.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="妄越">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/01/14/json查找所有地方/" itemprop="url">json 查找各个地方呀</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-01-14T08:00:00+08:00">
                2019-01-14
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing">
                  <a href="/categories/python/" itemprop="url" rel="index">
                    <span itemprop="name">python</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>import urllib.request<br>import urllib.parse<br>import json</p>
<p>ab = input(‘请输入关键字’)<br>cd = input(‘城市’)</p>
<h1 id="http-api-map-baidu-com-place-v2-suggestion-query-天安门-amp-region-北京-amp-city-limit-true-amp-output-json-amp-ak-你的ak-GET请求"><a href="#http-api-map-baidu-com-place-v2-suggestion-query-天安门-amp-region-北京-amp-city-limit-true-amp-output-json-amp-ak-你的ak-GET请求" class="headerlink" title="http://api.map.baidu.com/place/v2/suggestion?query=天安门&amp;region=北京&amp;city_limit=true&amp;output=json&amp;ak=你的ak //GET请求"></a><a href="http://api.map.baidu.com/place/v2/suggestion?query=天安门&amp;region=北京&amp;city_limit=true&amp;output=json&amp;ak=你的ak" target="_blank" rel="noopener">http://api.map.baidu.com/place/v2/suggestion?query=天安门&amp;region=北京&amp;city_limit=true&amp;output=json&amp;ak=你的ak</a> //GET请求</h1><p>args = {‘query’: ab, ‘region’: cd,  ‘output’: ‘json’,’ak’: ‘S2uzcu5og9j5h2tWPrBR9H0Fw8jiq9Wo’}<br>b64_args = urllib.parse.urlencode(args)<br>print(b64_args)<br>base_url = ‘<a href="http://api.map.baidu.com/place/v2/search&#39;" target="_blank" rel="noopener">http://api.map.baidu.com/place/v2/search&#39;</a><br>url = base_url + ‘?’ + b64_args</p>
<p>resp = urllib.request.urlopen(url)<br>content_json = resp.read().decode()</p>
<h1 id="json转对象"><a href="#json转对象" class="headerlink" title="json转对象"></a>json转对象</h1><p>content_obj = json.loads(content_json)</p>
<p>results = content_obj[‘results’]<br>for row in results:<br>    print(row[‘name’], row[‘address’])</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/01/11/等你下课/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="妄越">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/yifenga.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="妄越">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/01/11/等你下课/" itemprop="url">doa</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-01-11T21:32:30+08:00">
                2019-01-11
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing">
                  <a href="/categories/随笔/" itemprop="url" rel="index">
                    <span itemprop="name">随笔</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="随笔"><a href="#随笔" class="headerlink" title="随笔"></a>随笔</h1><pre><code>等你下课（自改版）
</code></pre><p>我住的巷子里 你租了一间公寓 为了想与我不期而遇<br>高中几年 你为什么 为什么不好好读书 没考上跟我一样的大学<br>你找了份工作 离我宿舍很近<br>当你开始学会做蛋饼 我却逗你 我不吃早餐<br>喔 怎么擦肩而过 你耳机听什么 能不能告诉我<br>躺在我学校的操场看星空 教室里的灯还亮着 我不走<br>记得 你写给我的情书 都什么年代了 到现在你还在写着<br>总有一天 总有一年会发现 有人默默的陪在我的身边<br>也许 我不该在你的世界 当我收到情书 为什么你已走远<br>学校旁的广场 你在那等钟声响 等我下课 一起走好吗<br>弹着琴 唱我爱的歌 暗恋真的挺痛苦 我说喜欢你 你却不信我<br>你唱这么走心 早已走进我心里 在人来人往找寻着你 守护着你 不求结局<br>喔 怎么擦肩而过 你唱告白气球 终于我回了头<br>躺在你学校的操场看星空 教室里的灯还亮着你别走<br>记得 你写给我的情书 都什么年代了 每一封都还在留着<br>总有一天总有一年会发现 你一直默默的陪在我身边<br>不管 该不该在你的世界 当我收到情书 请你做我的小永远</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/01/11/自动售货机/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="妄越">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/yifenga.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="妄越">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/01/11/自动售货机/" itemprop="url">自动售货机</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-01-11T21:32:30+08:00">
                2019-01-11
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing">
                  <a href="/categories/python/" itemprop="url" rel="index">
                    <span itemprop="name">python</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>自动售货机<br>goods_list =[{‘name’:’Coke Cola’,’stock’:40,’price’:3},<br>             {‘name’:’Mineral water’,’stock’:40,’price’:2},<br>             {‘name’:’cafe’,’stock’:40,’price’:5}]<br>money = [{‘par value’:’一元’,’Initial quantity’:50},{‘par value’:’二元’,’Initial quantity’:30},{‘par value’:’五元’,’Initial quantity’:20},{‘par value’:’十元’,’Initial quantity’:10}]<br>global balance<br>balance = 0<br>def main_menu():<br>    print(‘’’<br>    你好，有如下商品可供你选择：<br>    1）.可乐-3       2）.矿泉水-2     3）.咖啡-5’’’)<br>def pay_coin():<br>    user_pay_num = int(input(‘投币:’))<br>    if user_pay_num == 0:<br>        query_goods()<br>    elif user_pay_num == 1 or user_pay_num == 2 or user_pay_num == 5 or user_pay_num == 10:<br>        global balance<br>        balance = balance + user_pay_num<br>    else:<br>        print(‘Error’)<br>        pay_coin()<br>    if user_pay_num == 1:<br>        money[1][‘Initial quantity’] = money[1][‘Initial quantity’] + 1<br>    if user_pay_num == 2:<br>        money[2][‘Initial quantity’] = money[2][‘Initial quantity’] + 1<br>    if user_pay_num == 5:<br>        money[3][‘Initial quantity’] = money[3][‘Initial quantity’] + 1<br>    if user_pay_num == 10:<br>        money[4][‘Initial quantity’] = money[4][‘Initial quantity’] + 1<br>def chose_goods():<br>    global balance<br>    print(‘按0退出’)<br>    order = int(input(‘需要点什么:’))<br>    if order == 1:<br>        if goods_list[1][‘stock’] &gt; 0:<br>            if balance - 3 &gt;= 0:<br>                goods_list[1][‘stock’] = goods_list[1][‘stock’] - 1<br>                balance = balance -3<br>                print(‘咣当（饮料落地声）’)<br>                if balance != 0:<br>                    chose_goods()<br>                else:<br>                    print(‘欢迎下次使用’)<br>            else:<br>                print(‘请继续投币’)<br>                pay_coin()<br>                chose_goods()<br>        else:<br>            print(‘已售完’)<br>            chose_goods()<br>    elif order == 2:<br>        if goods_list[2][‘stock’] &gt; 0:<br>            if balance - 2 &gt;= 0:<br>                goods_list[2][‘stock’] = goods_list[2][‘stock’] - 1<br>                balance = balance -2<br>                print(‘咣当（饮料落地声）’)<br>                if balance != 0:<br>                    chose_goods()<br>                else:<br>                    print(‘欢迎下次使用’)<br>            else:<br>                print(‘请继续投币’)<br>                pay_coin()<br>                chose_goods()<br>        else:<br>            print(‘已售完’)<br>            chose_goods()<br>    elif order == 3:<br>        if goods_list[3][‘stock’] &gt; 0:<br>            if balance - 5 &gt;= 0:<br>                goods_list[3][‘stock’] = goods_list[3][‘stock’] - 1<br>                balance = balance -5<br>                print(‘咣当（饮料落地声）’)<br>                if balance != 0:<br>                    chose_goods()<br>                else:<br>                    print(‘欢迎下次使用’)<br>            else:<br>                print(‘请继续投币’)<br>                pay_coin()<br>                chose_goods()<br>        else:<br>            print(‘已售完’)<br>            chose_goods()<br>    elif order == 0:<br>        return_coin()<br>def return_coin():<br>    if balance == 1:<br>        money[1][‘Initial quantity’] = money[1][‘Initial quantity’] - 1<br>        print(‘找零一元’)<br>    elif balance == 2:<br>        money[2][‘Initial quantity’] = money[2][‘Initial quantity’] - 1<br>        print(‘找零二元’)<br>    elif balance == 3:<br>        money[1][‘Initial quantity’] = money[1][‘Initial quantity’] - 1<br>        money[2][‘Initial quantity’] = money[2][‘Initial quantity’] - 1<br>        print(‘找零三元’)<br>    elif balance == 4:<br>        money[2][‘Initial quantity’] = money[2][‘Initial quantity’] - 2<br>        print(‘找零四元’)<br>    elif balance == 5:<br>        money[3][‘Initial quantity’] = money[3][‘Initial quantity’] - 1<br>        print(‘找零五元’)<br>    elif balance == 6:<br>        money[1][‘Initial quantity’] = money[1][‘Initial quantity’] - 1<br>        money[3][‘Initial quantity’] = money[3][‘Initial quantity’] - 1<br>        print(‘找零六元’)<br>    elif balance == 7:<br>        money[2][‘Initial quantity’] = money[2][‘Initial quantity’] - 1<br>        money[3][‘Initial quantity’] = money[3][‘Initial quantity’] - 1<br>        print(‘找零七元’)<br>    elif balance == 8:<br>        money[1][‘Initial quantity’] = money[1][‘Initial quantity’] - 1<br>        money[2][‘Initial quantity’] = money[2][‘Initial quantity’] - 1<br>        money[3][‘Initial quantity’] = money[3][‘Initial quantity’] - 1<br>        print(‘找零八元’)<br>    elif balance == 9:<br>        money[2][‘Initial quantity’] = money[2][‘Initial quantity’] - 2<br>        money[3][‘Initial quantity’] = money[3][‘Initial quantity’] - 1<br>        print(‘找零9元’)<br>    reset()<br>def query_goods():<br>    print(‘1).商品信息  2).钱盒信息 0).退出\n’)<br>    order1 = int(input(‘’))<br>    if order1 == 1:<br>        print(‘商品序号’, ‘\t\t’, ‘商品名称’, ‘\t’, ‘库存’, ‘\t’, ‘价格’)<br>        print(‘-‘ <em> 50)<br>        for i in range(0, len(goods_list)):<br>            print(i + 1, ‘\t\t\t’, goods_list[i][‘name’], ‘\t’, goods_list[i][‘stock’], ‘\t’, goods_list[i][‘price’])<br>    elif order1 == 2:<br>        print(‘面值’, ‘\t’, ‘数量’)<br>        print(‘-‘ </em> 50)<br>        for i in range(0, len(money)):<br>            print(money[i][‘par value’], ‘\t’, money[i][‘Initial quantity’])<br>    elif order1 == 0:<br>        pay_coin(balance)<br>def reset():<br>    global balance<br>    balance = 0<br>while True:<br>    main_menu()<br>    pay_coin()<br>    chose_goods()</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/01/10/京东评论存入数据库/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="妄越">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/yifenga.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="妄越">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/01/10/京东评论存入数据库/" itemprop="url">京东爬取数据</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-01-10T08:00:00+08:00">
                2019-01-10
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing">
                  <a href="/categories/python/" itemprop="url" rel="index">
                    <span itemprop="name">python</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="京东评论写数据库s"><a href="#京东评论写数据库s" class="headerlink" title="京东评论写数据库s"></a>京东评论写数据库s</h1><p>import requests<br>import json<br>from lxml import etree<br>import pymysql.cursors<br>import time</p>
<p>def get_comments(product_id=None, page=None, page_size=10):<br>    “””<br>    取评论<br>    :return: [[id,username,score,], []]或 [{‘id’:123123, ‘username’: ‘zzdxyz’, ‘score’: 5}]<br>    “””<br>    comment_url = ‘<a href="https://sclub.jd.com/comment/productPageComments.action&#39;" target="_blank" rel="noopener">https://sclub.jd.com/comment/productPageComments.action&#39;</a></p>
<pre><code>params = {
    &apos;productId&apos;: product_id,  # 商品id。先写死 苹果手机。
    &apos;score&apos;: 0,
    &apos;sortType&apos;: 5,
    &apos;page&apos;: page,
    &apos;pageSize&apos;: page_size,
    # &apos;callback&apos;: &apos;fetchJSON_comment98vv15261&apos;,
    # &apos;isShadowSku&apos;: 0,
    # &apos;fold&apos;: 1
}

# 伪造headers。 降低被封禁的概率。
# cookie中有jsessionid和trackid和用户名等信息。referer请求前的页面地址。useragent浏览器标识。
headers = {
    &apos;cookie&apos;: &apos;shshshfpa=c5912ac8-f696-63a4-437d-20191204d1d8-1531666020; shshshfpb=01a876290501e22aca53c7218c89142ee978ad3d34afa32745b4ada524; pinId=uGywawhW5xQ; aud=c5a66c2779ef975e95c2e6bcd122076f; aud_ver=2; __jdu=15316322076781797028717; ipLocation=%u5317%u4EAC; ipLoc-djd=1-72-2799-0; avt=3; PCSYCityID=412; pin=zzdxyz; unick=%E7%BB%86%E8%BD%AF%E8%B7%91; _tp=EtAWqzuy%2FaNSh0LFcTfGgQ%3D%3D; _pst=zzdxyz; cn=0; user-key=bb1ddddd-6808-4a0a-9ef0-486272214fae; __jdc=122270672; TrackID=12_A_Uj3VhNwy96E08U546kjQ_OUDLBz9oe6SY1cKBy1gC5rvObnItC79-lh5xLhs1PpIIwwihGx4x848lXXJlC4IZxqw1EA3ZggiJZ6bX10; thor=1206B4BD372EF4F47D5ADB6E04093C1CF85E72A62CDA84A850575F6121C961C7920737265283260552283BC968C129ACF74176D4C8098D5A2F0F4FCB9EEB1943329E4CD3624DFB217BB4783B7FC6A054B9D577B323AFE4D0AC64F3456BB34D18C1441378FB2E314B30B0C41B982FD9C11F6993C370717B280220CBF466E16BF8; ceshi3.com=000; unpl=V2_ZzNtbUdfQhUlWxJdKx0OBmJREV9KV0QTd11CVH0dCAxlBBFfclRCFX0UR1RnGF4UZwIZXEZcRhZFCEdkexhdBGMBFFpHVnMldDhFVEsRbAVjARJaQFRAFHMPQF17H1QDZgAbW0JRcyVyOHYIP0AMQzkzElhEU0EQfAxDVEsYbAViBRpcR1VCFXA4DTp6VFwBZQMVX0FUQhNyDk9UfRFaBGQKFF1EZ0Ildg%3d%3d; __jda=122270672.15316322076781797028717.1531632208.1546481134.1546481144.36; __jdb=122270672.1.15316322076781797028717|36.1546481144; __jdv=122270672|dh.tbyuantu.com|t_1000537640_|tuiguang|4901abe8a5c24c2391673d5175e83623|1546481143668; shshshfp=66ae7625488a03ea74ef89c454100a41; shshshsID=3536f0e04a4e914beb2a3be569e1cb2d_1_1546481147922&apos;,
    &apos;referer&apos;: &apos;https://item.jd.com/100000287113.html&apos;,
    &apos;user-agent&apos;: &apos;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/71.0.3578.98 Safari/537.36&apos;,
}

comment_resp = requests.get(url=comment_url, params=params, headers=headers)
print(comment_resp.status_code)
comment_str = comment_resp.text

comment_dict = json.loads(comment_str)
# comment_dict = json.load(&apos;4js接口-京东评论-评论数据.json&apos;)
comments = comment_dict[&apos;comments&apos;]

result_list = []
for comment in comments:
    result_list.append({
        &apos;id&apos;: comment[&apos;id&apos;],
        &apos;content&apos;: comment[&apos;content&apos;],
        &apos;creation_time&apos;: comment[&apos;creationTime&apos;],
        &apos;score&apos;: comment[&apos;score&apos;],
        &apos;nickname&apos;: comment[&apos;nickname&apos;],
        &apos;product_color&apos;: comment[&apos;productColor&apos;],
        &apos;product_size&apos;: comment[&apos;productSize&apos;]
    })

return result_list
</code></pre><p>def save_db(comments):<br>    “””<br>    :param: comments: {list} [{‘id’:123123, ‘content’:’物美价廉东西不错’, },{}]<br>    :return: affected_rows : {int} 成功写入的行数<br>    “””<br>    connection = pymysql.connect(host=’127.0.0.1’, port=3306,<br>                                 user=’root’,<br>                                 password=’dadong’,<br>                                 db=’jd’,<br>                                 charset=’utf8mb4’, cursorclass=pymysql.cursors.DictCursor<br>                                 )<br>    affected_rows = 0  # 成功计数</p>
<pre><code>for comment in comments:  # 循环评论
    cursor = connection.cursor()  # 创建游标
    # 先判断一下是否已存储过
    sql1 = &quot;select id from comment where comment_id=%s &quot; % (comment[&apos;id&apos;])
    cursor.execute(sql1)
    rs_set = cursor.fetchone()  # 有值返回{&apos;id&apos;:23} 无值返回None
    if rs_set:
        print(&apos;这条评论已存在在数据库中&apos;)
        continue
    # 不存在的写入数据库
    # 写法一： 参数为列表或元组  占位符 %s
    # sql2 = &quot;&quot;&quot;
    # insert into comment (comment_id, content, creation_time, score, nickname, product_color, product_size)
    # values (%s, %s, %s, %s, %s,   %s, %s,)
    # &quot;&quot;&quot;
    # 注意不要在拼sql的时候通过python字符串格式化（% .formate f&apos;&apos;）传参，应该cursor.execute(args=)传参。
    # cursor.execute(sql2, args=(comment[&apos;id&apos;], comment[&apos;content&apos;], ...))     # 参数为列表或元组

    # 写法二：参数为字典
    sql2 = &quot;&quot;&quot;
    insert into comment (comment_id, content, creation_time, score, nickname, product_color, product_size)
     values (%(id)s, %(content)s, %(creation_time)s, %(score)s, %(nickname)s,   %(product_color)s, %(product_size)s)
    &quot;&quot;&quot;
    affected_row = cursor.execute(sql2, args=comment)
    if affected_row:
        print(&apos;本条评论插入成功&apos;)
        affected_rows += affected_row

    # 写法三：批量插入，拼sql
    # 写法四：批量插入，用现成方法executemany
connection.commit()
return affected_rows
</code></pre><p>if <strong>name</strong> == ‘<strong>main</strong>‘:<br>    product_id = 100000287113  # 先写死，固定为一个商品下的评论<br>    page_amount = 10  # 爬取总页数，注意不要传给get_comments()函数导致每次请求固定的一页<br>    page_size = 10  # 每页10条评论<br>    time_sleep = 2</p>
<pre><code>for page in range(0, page_amount):
    comments_list = get_comments(product_id, page, page_size)
    affected_rows = save_db(comments=comments_list)
    print(f&apos;成功写入{affected_rows}&apos;)
    time.sleep(2)

print(&apos;Done&apos;)
</code></pre><p>“””<br>报错：</p>
<ol>
<li>id int默认4字节太短  应该bigint</li>
<li>content中有单引号导致拼出的sql错误，应该在cursor.excute<br>sql = ‘insert into comment (comment_id, content) values (%s, %s);’ % (111232, ‘物美价廉’)<br>sql = ‘insert into comment (comment_id, content) values ({}, {});’.format(111232, ‘这个商品’太好’了！’)<br>‘insert into comment (comment_id, content) values (111232, ‘这个商品’太好’了！’);’导致报错<br>cursor.execute(sql)<br>所以参数应该在cursor.execute(sql, args=(111232, ‘这个商品’太好’了！’))</li>
<li>indent error 缩进错误。  怀疑sql三引号中有一个空格，换行后变为5个空格。<br>“””</li>
</ol>
<p>“””<br>批量插入：<br>手动拼sql<br>1.insert into comment(comment_id,content) values(111232,’这个商品太好了’),<br>                                              (11233,’不错’),(11233,’真好’);<br>sql = ‘insert into comment (comment_id,content) values’<br>for comment in comments:<br>    sql += ‘(‘<br>    sql += comment[‘id’]<br>    sql +=comment[‘content’]<br>    sql += ‘)’<br>    sql += ‘,’<br>cursor.excute(sql)<br>2.手动拼写比较麻烦容易出错，所以用现成的cursor.excutemany()<br>sql = ‘insert into comment comment_id,<br>“””</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/01/09/判断中英文/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="妄越">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/yifenga.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="妄越">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/01/09/判断中英文/" itemprop="url">python</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-01-09T20:54:12+08:00">
                2019-01-09
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>def is_chinese(uchar):<br>    “””<br>    判断是否为纯汉字<br>    :param uchar:<br>    :return:<br>    “””<br>    if uchar&gt;= u’\u4e00’ and uchar&lt;= u’\u9fa5’:<br>        return True<br>    else:<br>        return False</p>
<p>def is_number(uchar):<br>    “””<br>    判断是否为纯数字<br>    :param uchar:<br>    :return:<br>    “””<br>    if  uchar &gt;= u’\0030’ and uchar&lt;= u’\u0039’:<br>        return True<br>    else:<br>        return False</p>
<p>def is_alphabet(uchar):</p>
<pre><code>&quot;&quot;&quot;判断一个unicode是否是英文字母&quot;&quot;&quot;

if (uchar &gt;= u&apos;\u0041&apos; and uchar&lt;=u&apos;\u005a&apos;) or (uchar &gt;= u&apos;\u0061&apos; and uchar&lt;=u&apos;\u007a&apos;):

    return True

else:

    return False
</code></pre><p>def is_other(uchar):</p>
<pre><code>&quot;&quot;&quot;判断是否非汉字，数字和英文字符&quot;&quot;&quot;

if not (is_chinese(uchar) or is_number(uchar) or is_alphabet(uchar)):

    return True

else:

    return False
</code></pre><p>def string2List(ustring):</p>
<pre><code>&quot;&quot;&quot;将ustring按照中文，字母，数字分开&quot;&quot;&quot;
Chinese = []    # 中文字符
English = []    # 英文字符
Number = []     # 数字字符
Other = []      # 其他字符
for uchar in ustring:
    if is_chinese(uchar):
        Chinese.append(uchar)
    elif is_alphabet(uchar):
        English.append(uchar)
    elif is_number(uchar):
        Number.append(uchar)
    else:
        is_other(uchar)
        Other.append(uchar)

if len(Chinese) != 0 and len(English) ==0 and len(Number) == 0 and len(Other)== 0:
    print(&apos;您输入的字符为纯汉字&apos;)
elif len(Chinese) == 0 and len(English) != 0 and len(Number) == 0 and len(Other) == 0:
    print(&apos;您输入的字符为纯英文&apos;)
elif len(Chinese) == 0 and len(English) == 0 and len(Number) != 0 and len(Other) == 0:
    print(&apos;您输入的字符为纯数字&apos;)
elif len(Chinese) != 0 or len(English) != 0 or len(Number) != 0 or len(Other) != 0:
    print(&apos;您输入的字符为混合字符&apos;)
else:
    print(&apos;您输入的字符为特殊字符&apos;)
</code></pre><p>def run():<br>    “””<br>    运行函数<br>    :return:<br>    “””<br>    while True:<br>        string = input(‘输入要测试的字符：’)<br>        string2List(string)<br>        is_next = input(‘y继续，任意字符退出：’)<br>        if is_next == ‘y’:<br>            run()<br>        else:<br>            break</p>
<p>if <strong>name</strong> == “<strong>main</strong>“:<br>    run()</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
  </section>

  


          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      

      <section class="site-overview-wrap sidebar-panel sidebar-panel-active">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope="" itemtype="http://schema.org/Person">
            
              <img class="site-author-image" itemprop="image" src="/images/yifenga.jpg" alt="妄越">
            
              <p class="site-author-name" itemprop="name">妄越</p>
              <p class="site-description motion-element" itemprop="description"></p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/">
              
                  <span class="site-state-item-count">5</span>
                  <span class="site-state-item-name">日志</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-categories">
                <a href="/categories/index.html">
                  <span class="site-state-item-count">2</span>
                  <span class="site-state-item-name">分类</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-tags">
                <a href="/tags/index.html">
                  <span class="site-state-item-count">2</span>
                  <span class="site-state-item-name">标签</span>
                </a>
              </div>
            

          </nav>

          

          
            <div class="links-of-author motion-element">
                
                  <span class="links-of-author-item">
                    <a href="https://github.com/yourname" target="_blank" title="GitHub">
                      
                        <i class="fa fa-fw fa-github"></i>GitHub</a>
                  </span>
                
                  <span class="links-of-author-item">
                    <a href="mailto:yourname@gmail.com" target="_blank" title="E-Mail">
                      
                        <i class="fa fa-fw fa-envelope"></i>E-Mail</a>
                  </span>
                
                  <span class="links-of-author-item">
                    <a href="https://weibo.com/5242864736/profile?topnav=1&wvr=6" target="_blank" title="微博">
                      
                        <i class="fa fa-fw fa-weibo"></i>微博</a>
                  </span>
                
            </div>
          

          
          

          
          

          

        </div>
      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2019</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">妄越</span>

  
</div>


  <div class="powered-by">由 <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a> 强力驱动</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">主题 &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Gemini</a> v5.1.4</div>




        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  




  
  









  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  

  
  
    <script type="text/javascript" src="/lib/three/three.min.js"></script>
  

  
  
    <script type="text/javascript" src="/lib/three/three-waves.min.js"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.4"></script>



  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script>



  


  




	





  





  












  





  

  

  

  
  

  

  

  

  
<!-- 页面点击小红心 -->
<script type="text/javascript" src="/js/src/love.js"></script>
  
</body>
</html>
